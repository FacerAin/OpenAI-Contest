{"ast":null,"code":"var _interopRequireDefault=require(\"@babel/runtime/helpers/interopRequireDefault\");Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=exports.submit=exports.load=exports.change=void 0;var _defineProperty2=_interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));var _regenerator=_interopRequireDefault(require(\"@babel/runtime/regenerator\"));var _api=require(\"../lib/api\");var _Alert=_interopRequireDefault(require(\"react-native-web/dist/exports/Alert\"));var _readTest=require(\"../lib/readTest\");var _sqlite=_interopRequireDefault(require(\"../lib/sqlite\"));function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach(function(key){(0,_defineProperty2.default)(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}var LOAD='search/LOAD';var CHANGE='search/CHANGE';var SUCCESS='search/SUCCESS';var FAILURE='search/FAILURE';var START='search/START';var change=function change(text){return{type:CHANGE,text:text};};exports.change=change;var load=function load(){return function _callee(dispatch){var past;return _regenerator.default.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _regenerator.default.awrap(_sqlite.default.select());case 2:past=_context.sent;_context.next=5;return _regenerator.default.awrap(past.map(function(elem){return elem.score;}));case 5:past=_context.sent;dispatch({type:LOAD,past:past});case 7:case\"end\":return _context.stop();}}});};};exports.load=load;var submit=function submit(text){return function _callee2(dispatch){var response,tempScore,past;return _regenerator.default.async(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch({type:START});_context2.prev=1;_context2.next=4;return _regenerator.default.awrap((0,_api.sendSearch)(text.nativeEvent.text));case 4:response=_context2.sent;tempScore=scoring(response.return_data).full;_context2.next=8;return _regenerator.default.awrap(_sqlite.default.insert(tempScore));case 8:_context2.next=10;return _regenerator.default.awrap(_sqlite.default.select());case 10:past=_context2.sent;past=past.map(function(elem){return elem.score;});dispatch({type:SUCCESS,result:response,past:past});_context2.next=19;break;case 15:_context2.prev=15;_context2.t0=_context2[\"catch\"](1);console.log(_context2.t0);dispatch({type:FAILURE});case 19:case\"end\":return _context2.stop();}}},null,null,[[1,15]]);};};exports.submit=submit;var initialState={query:'',result:{return_data:{searchResults:[]}},isLoading:false,pastScore:[10,10,10,10,10,10]};var _default=ToggleLoading=function ToggleLoading(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case CHANGE:return _objectSpread({},state,{query:action.text});case SUCCESS:return _objectSpread({},state,{isLoading:false,result:action.result,pastScore:action.past});case FAILURE:return _objectSpread({},state,{isLoading:false});case START:return _objectSpread({},state,{query:'',isLoading:true});case LOAD:return _objectSpread({},state,{pastScore:action.past});default:return state;}};exports.default=_default;","map":{"version":3,"sources":["C:/Users/bluej/Desktop/2_2/searchGuide/searchGuide/reducers/search.js"],"names":["LOAD","CHANGE","SUCCESS","FAILURE","START","change","text","type","load","dispatch","sqlite","select","past","map","elem","score","submit","nativeEvent","response","tempScore","scoring","return_data","full","insert","result","console","log","initialState","query","searchResults","isLoading","pastScore","ToggleLoading","state","action"],"mappings":"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","sourcesContent":["import {sendSearch} from '../lib/api'\r\nimport {Alert} from 'react-native'\r\nimport {readTest} from '../lib/readTest';\r\nimport sqlite from '../lib/sqlite';\r\n\r\nconst LOAD = 'search/LOAD';\r\nconst CHANGE = 'search/CHANGE';\r\nconst SUCCESS = 'search/SUCCESS';\r\nconst FAILURE = 'search/FAILURE';\r\nconst START = 'search/START';\r\n\r\nexport const change = (text) => ({ \r\n    type: CHANGE,\r\n    text,\r\n})\r\n\r\nexport const load = () => async (dispatch) =>{\r\n    let past = await sqlite.select();\r\n    past = await past.map( elem => elem.score );\r\n    dispatch({type:LOAD, past: past})\r\n}\r\n\r\nexport const submit = (text) => async (dispatch) => { \r\n    dispatch( {type:START});\r\n    try{\r\n        const response = await sendSearch(text.nativeEvent.text);\r\n        let tempScore = scoring(response.return_data).full;\r\n        await sqlite.insert(tempScore);\r\n        let past = await sqlite.select();\r\n        past = past.map( elem => elem.score );\r\n        //dispatch( { type:SUCCESS, result:response }\r\n        dispatch( { type:SUCCESS, result:response, past: past})\r\n    }\r\n    catch(err){\r\n        console.log(err);\r\n        /* Alert.alert(\r\n            'error',\r\n            [\r\n                {text: '확인', onPress: () => {}},\r\n            ],\r\n        ) */\r\n        dispatch({ type:FAILURE })\r\n    }\r\n}\r\n\r\n\r\nconst initialState = {\r\n    query: '',\r\n    result: {\r\n        return_data: {\r\n            searchResults: []\r\n        }   \r\n    },\r\n    isLoading: false,\r\n    pastScore: [10,10,10,10,10,10],\r\n};\r\n   \r\nexport default ToggleLoading = (state = initialState, action) => {\r\n    switch (action.type) {\r\n        case CHANGE:\r\n            return {...state, query: action.text};\r\n        case SUCCESS:\r\n            return {...state, isLoading:false,result: action.result, pastScore: action.past};\r\n        case FAILURE:\r\n            return {...state, isLoading:false};\r\n        case START:\r\n            return {...state, query:'',isLoading:true}\r\n        case LOAD:\r\n            return {...state,pastScore: action.past}\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\n\r\n"]},"metadata":{},"sourceType":"script"}